<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

</body>
</html>

{% extends 'base.html' %}

{% block title %}Issue #{{ issue.id }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>{{ issue.title }}</h2>
    <p><strong>Status:</strong> {{ issue.status }}</p>
    <p><strong>Priority:</strong> {{ issue.priority }}</p>
    <p><strong>Assignee:</strong> {{ issue.assignee.username if issue.assignee else '—' }}</p>
    <p><strong>Created:</strong> {{ issue.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
    <p><strong>Updated:</strong> {{ issue.updated_at.strftime('%Y-%m-%d %H:%M') }}</p>
    <hr>
    <p>{{ issue.description or 'No description provided.' }}</p>
    <a href="{{ url_for('issues.list_issues') }}" class="btn btn-secondary mt-3">← Back to list</a>
</div>
{% endblock %}

<hr>
<p>{{ issue.description or 'No description provided.' }}</p>

<div class="mt-4">
    <a href="{{ url_for('issues.edit_issue', issue_id=issue.id) }}" class="btn btn-warning">✏️ Edit Issue</a>
    <a href="{{ url_for('issues.list_issues') }}" class="btn btn-secondary ms-2">← Back to list</a>
</div>

<h4 class="mt-5">Comments</h4>
{% for comment in issue.comments %}
    <div class="border rounded p-2 mb-2">
        <strong>User {{ comment.author_id }}</strong> — {{ comment.created_at.strftime('%Y-%m-%d %H:%M') }}<br>
        {{ comment.text }}
    </div>
{% else %}
    <p>No comments yet.</p>
{% endfor %}

<form method="POST" action="{{ url_for('issues.add_comment', issue_id=issue.id) }}" class="mt-4">
    {{ comment_form.hidden_tag() }}
    <div class="mb-3">
        {{ comment_form.text.label(class="form-label") }}
        {{ comment_form.text(class="form-control", rows="3") }}
    </div>
    <div class="mb-3">
        {{ comment_form.author_id.label(class="form-label") }}
        {{ comment_form.author_id(class="form-control") }}
    </div>
    <button type="submit" class="btn btn-primary">{{ comment_form.submit.label.text }}</button>
</form>

<form method="POST" action="{{ url_for('issues.delete_issue', issue_id=issue.id) }}" onsubmit="return confirm('Are you sure you want to delete this issue?');">
    <button type="submit" class="btn btn-danger mt-3">🗑️ Delete Issue</button>
</form>

<div class="border rounded p-3 mb-4 bg-light">
    <h4>{{ issue.title }}</h4>
    <p>Status: <span class="badge bg-warning text-dark">{{ issue.status }}</span></p>
    <p>Priority: <strong>{{ issue.priority }}</strong></p>
    <p>Assignee: {{ issue.assignee.username if issue.assignee else '—' }}</p>
    <p>Created: {{ issue.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
    <p>Updated: {{ issue.updated_at.strftime('%Y-%m-%d %H:%M') }}</p>
</div>

<a href="{{ url_for('issues.edit_issue', issue_id=issue.id) }}" class="btn btn-warning">
    <i class="bi bi-pencil"></i> Edit Issue
</a>
<form method="POST" action="{{ url_for('issues.delete_issue', issue_id=issue.id) }}" onsubmit="return confirm('Are you sure?');">
    <button type="submit" class="btn btn-danger">
        <i class="bi bi-trash"></i> Delete
    </button>
</form>
